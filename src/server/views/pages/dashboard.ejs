<div class="container my-5" id="main-content">
	<div class="d-flex justify-content-between align-items-center mb-4">
		<h1 class="mb-0">StreamBot Video Manager</h1>
	</div>

	<ul class="nav nav-tabs mb-3" id="myTab" role="tablist">
		<li class="nav-item" role="presentation">
			<button class="nav-link active" id="list-tab"
				data-bs-toggle="tab" data-bs-target="#list" type="button" role="tab"
				aria-controls="list" aria-selected="true" aria-label="View file list">File List</button>
		</li>
		<li class="nav-item" role="presentation">
			<button class="nav-link" id="upload-tab"
				data-bs-toggle="tab" data-bs-target="#upload" type="button" role="tab"
				aria-controls="upload" aria-selected="false" aria-label="Upload new files">Upload</button>
		</li>
	</ul>

	<div class="tab-content" id="myTabContent">
		<div class="tab-pane fade show active" id="list" role="tabpanel" aria-labelledby="list-tab">
			<div class="card">
				<div class="card-header">
					<h5 class="card-title mb-0">Video Files</h5>
				</div>
				<div class="card-body">
					<div class="table-responsive">
						<table class="table table-striped" role="table" aria-label="Video files list">
							<thead>
								<tr role="row">
									<th scope="col" role="columnheader">Name</th>
									<th scope="col" role="columnheader">Size</th>
									<th scope="col" role="columnheader">Actions</th>
								</tr>
							</thead>
							<tbody>
								<% if (typeof files !== 'undefined' && files.length > 0) { %>
									<% files.forEach(function(file) { %>
									<tr>
										<td><%= file.name %></td>
										<td><%= file.size %></td>
										<td>
											<a href="/preview/<%= encodeURIComponent(file.name) %>" class="btn btn-sm btn-outline-primary me-1 btn-icon"
											   aria-label="Preview <%= file.name %>" title="Preview <%= file.name %>">
												<i class="fas fa-eye" aria-hidden="true"></i>
											</a>
											<button class="btn btn-sm btn-outline-secondary me-1 btn-icon"
													onclick="copyFileName('<%= file.name %>')"
													aria-label="Copy <%= file.name %> to clipboard"
													title="Copy <%= file.name %> to clipboard">
												<i class="fas fa-clipboard" aria-hidden="true"></i>
											</button>
											<button class="btn btn-sm btn-outline-danger btn-icon"
													aria-label="Delete <%= file.name %>"
													title="Delete <%= file.name %>"
													onclick="showDeleteModal('<%= file.name %>', '/delete/<%= encodeURIComponent(file.name) %>')">
												<i class="fas fa-trash" aria-hidden="true"></i>
											</button>
										</td>
									</tr>
									<% }); %>
								<% } else { %>
									<tr>
										<td colspan="3" class="text-center text-muted">No video files found</td>
									</tr>
								<% } %>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
		<div class="tab-pane fade" id="upload" role="tabpanel" aria-labelledby="upload-tab">
			<div class="row">
				<div class="col-md-6 mb-3">
					<div class="card">
						<div class="card-header">
							<h5 class="card-title mb-0">Upload</h5>
						</div>
						<div class="card-body">
							<form action="/api/upload" method="post" enctype="multipart/form-data" id="localUploadForm">
								<div class="mb-3">
									<label for="localFileInput" class="form-label">Choose video file</label>
									<input type="file" class="form-control" id="localFileInput" name="file" accept="video/*" required>
								</div>
								<div class="mb-3 d-none" id="localProgressContainer">
									<label class="form-label">Upload Progress</label>
									<div class="progress" style="height: 25px;">
										<div class="progress-bar progress-bar-striped progress-bar-animated"
											 id="localProgressBar" role="progressbar" style="width: 0%">
											<span id="localProgressText">0%</span>
										</div>
									</div>
									<small class="text-muted" id="localProgressStatus">Starting upload...</small>
								</div>
								<div class="d-flex gap-2">
									<button type="button" class="btn btn-primary" id="localUploadBtn" onclick="startLocalUpload()">
										<span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
										<i class="fas fa-upload me-1" aria-hidden="true"></i>Upload
									</button>
									<button type="button" class="btn btn-secondary d-none" id="localCancelBtn" onclick="cancelLocalUpload()">
										<i class="fas fa-times me-1" aria-hidden="true"></i>Cancel
									</button>
								</div>
							</form>
						</div>
					</div>
				</div>
				<div class="col-md-6 mb-3">
					<div class="card">
						<div class="card-header">
							<h5 class="card-title mb-0">Remote Upload</h5>
						</div>
						<div class="card-body">
							<form action="/api/remote_upload" method="post" enctype="multipart/form-data" id="remoteUploadForm">
								<div class="mb-3">
									<label for="remoteFileInput" class="form-label">Enter video URL</label>
									<input type="url" class="form-control" id="remoteFileInput" name="link" placeholder="https://example.com/video.mp4" required>
								</div>
								<div class="mb-3 d-none" id="remoteProgressContainer">
									<label class="form-label">Download Progress</label>
									<div class="progress" style="height: 25px;">
										<div class="progress-bar progress-bar-striped progress-bar-animated bg-info"
											 id="remoteProgressBar" role="progressbar" style="width: 0%">
											<span id="remoteProgressText">0%</span>
										</div>
									</div>
									<small class="text-muted" id="remoteProgressStatus">Starting download...</small>
								</div>
								<div class="d-flex gap-2">
									<button type="button" class="btn btn-primary" id="remoteUploadBtn" onclick="startRemoteUpload()">
										<span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
										<i class="fas fa-download me-1" aria-hidden="true"></i>Download
									</button>
									<button type="button" class="btn btn-secondary d-none" id="remoteCancelBtn" onclick="cancelRemoteUpload()">
										<i class="fas fa-times me-1" aria-hidden="true"></i>Cancel
									</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Delete Confirmation Modal -->
	<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="deleteModalLabel">
						<i class="fas fa-exclamation-triangle text-warning me-2" aria-hidden="true"></i>
						Confirm Deletion
					</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="margin: 0;"></button>
				</div>
				<div class="modal-body">
					<div class="text-center mb-3">
						<i class="fas fa-trash text-danger fa-3x mb-3" aria-hidden="true"></i>
						<h6 class="mb-3">Are you sure you want to delete this video file?</h6>
						<p class="mb-2 text-muted">
							<strong id="deleteFileName"></strong>
						</p>
						<small class="text-muted">This action cannot be undone.</small>
					</div>
				</div>
				<div class="modal-footer justify-content-center">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
						<i class="fas fa-times me-1" aria-hidden="true"></i>Cancel
					</button>
					<a id="confirmDeleteBtn" href="#" class="btn btn-danger">
						<i class="fas fa-trash me-1" aria-hidden="true"></i>Delete File
					</a>
				</div>
			</div>
		</div>
	</div>
</div>